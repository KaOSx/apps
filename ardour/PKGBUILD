
pkgname=ardour
_pkgname=Ardour
pkgver=6.7.0
pkgrel=1
pkgdesc="A multichannel hard disk recorder and digital audio workstation"
arch=('x86_64')
url="https://ardour.org/"
license=('GPL')
depends=('atkmm' 'aubio' 'cairomm' 'gdk-pixbuf2' 'gtkmm' 'libx11' 'libxml2' 'pangomm' 'qjackctl' 'taglib' 'fftw' 'flac' 
         'graphviz' 'harfbuzz' 'liblo' 'liblrdf' 'libogg' 'pulseaudio' 'libsamplerate' 'libsndfile' 'lilv' 'lv2'
         'pango' 'readline' 'rubberband' 'serd' 'sord' 'sratom' 'suil')
makedepends=('boost' 'cppunit' 'itstool' 'libusb')
optdepends=('kde-gtk-config: gtk integration settings for Plasma')
options=('!strip')
source=("https://community.ardour.org/srctar"
        "https://github.com/Ardour/ardour/commit/cc7b8b1bc5fb19e0ec5e476741c55627d4b62ba9.diff")
md5sums=('cb2cc56036509f76f4292c7371820a8c'
         '97b3c03e76822d6e160d3662f497bf9d')

build() {
  cd ${_pkgname}-${pkgver}
  # glib2 2.68 needed
  #patch -p1 -i ${srcdir}/cc7b8b1bc5fb19e0ec5e476741c55627d4b62ba9.diff
  
  ./waf configure --prefix=/usr \
    --configdir=/etc \
    --with-backends="alsa,dummy,jack,pulseaudio" \
    --libjack=weak \
    --nls \
    --optimize \
    --cxx11 \
    --freedesktop \
    --ptformat \
    --lxvst \
    --no-phone-home
  ./waf build -v
}

package() {
  cd ${_pkgname}-${pkgver}

  ./waf i18n --destdir=${pkgdir}
  ./waf install --destdir=${pkgdir}
}
