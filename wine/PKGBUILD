
pkgname=wine
pkgver=9.19
_pkgver=9.x
__pkgver=9.19
pkgrel=1
pkgdesc="Compatibility layer capable of running Windows applications on several POSIX-compliant operating systems."
url="https://www.winehq.org"
arch=('x86_64')
license=('LGPL')
depends=('fontconfig' 'libxcursor' 'libxrandr' 'alsa-lib' 'desktop-file-utils' 'giflib'
         'jack' 'cups' 'gnutls' 'v4l-utils' 'libxinerama' 'ncurses' 'libxcomposite'
         'alsa-plugins' 'samba' 'gst-plugins-base' 'pulseaudio' 'sane'
         'libgphoto2' 'opencl-headers' 'vulkan-validationlayers' 'libxkbcommon' 'wayland')
makedepends=('autoconf' 'perl' 'fontforge' 'flex' 'libxpm')
install=wine.install
groups=('system')
source=("https://dl.winehq.org/wine/source/${_pkgver}/${pkgname}-${__pkgver}.tar.xz")
sha512sums=('530219c6a337f2996eac92d644ab603528b82cc6136cc37c1e6aa736d418f33c6f4b0d54f3537b04bceaf4487d84abcf926a2f5e9536ed4e966c4fe63c5b6ddd')

build() {
    mkdir -p build
    cd build

    ../${pkgname}-${__pkgver}/configure \
        --prefix=/usr \
        --sysconfdir=/etc \
        --libdir=/usr/lib \
        --with-x \
        --with-gstreamer \
        --enable-win64 \
        --with-wayland
    make
}

package() {
    cd build
    make prefix=${pkgdir}/usr libdir=${pkgdir}/usr/lib dlldir=${pkgdir}/usr/lib/wine install

    sed -i -e 's|wine start /unix %f|wine64 start /unix %f|' ${pkgdir}/usr/share/applications/wine.desktop
}


