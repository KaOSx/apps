
pkgname=mediainfo
_pkgname=MediaInfo
pkgver=20.09
pkgrel=1
pkgdesc="Convenient unified display of the most relevant technical and tag data for video and audio files."
arch=('x86_64')
url="https://github.com/MediaArea/MediaInfo"
license=('GPL')
depends=('mediainfolib' 'qt5-base')
makedepends=('libtool')
source=("https://github.com/MediaArea/MediaInfo/archive/v${pkgver}.tar.gz")
md5sums=('5814d9ed34be0719cc71a7d90967bc16')

prepare() {
  cd ${_pkgname}-${pkgver}
  
  #patch -p1 -i ${srcdir}/mediainfo-qt5.patch
}

build() {
  cd ${_pkgname}-${pkgver}/Project/GNU/CLI
  
  ./autogen.sh
  ./configure --prefix=/usr
  make
  
  cd ../../QMake/GUI
  
  /usr/lib/qt5/bin/qmake
  make
}

package() {
  cd ${_pkgname}-${pkgver}/Project/GNU/CLI
  make DESTDIR=${pkgdir} install
  
  cd ../../QMake/GUI
  make INSTALL_ROOT=${pkgdir} install
  
 install -D -m644 ../../GNU/GUI/mediainfo-gui.desktop ${pkgdir}/usr/share/applications/mediainfo-gui.desktop
 install -Dm 644 ../../../Source/Resource/Image/MediaInfo.svg ${pkgdir}/usr/share/icons/hicolor/scalable/apps/mediainfo.svg
}
