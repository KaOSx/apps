
# 1.x odd numbers are dev, not stable
pkgname=xdg-desktop-portal
pkgver=1.12.1
pkgrel=1
pkgdesc="Portal frontend service for Flatpak and possibly other desktop containment frameworks."
url="https://github.com/flatpak/xdg-desktop-portal"
arch=("x86_64")
license=('LGPL2.1')
depends=('fuse' 'glib2' 'pipewire')
makedepends=('python3' 'flatpak')
source=("https://github.com/flatpak/xdg-desktop-portal/releases/download/${pkgver}/${pkgname}-${pkgver}.tar.xz")
sha256sums=('f83e3f37c19d423e7dd5e205deca8560bffb00b1620023bd2536c1d4ff8b4358')

build() {
  cd ${pkgname}-${pkgver}

  ./configure --prefix=/usr \
    --libexecdir=/usr/lib \
    --enable-pipewire \
    --disable-geoclue \
    --disable-libportal
  make 
}

check() {
  cd ${pkgname}-${pkgver}
  # tests/test-document-fuse.sh fails and test-doc-portal - Bail out!
  make check
}

package() {
  cd ${pkgname}-${pkgver}

  make DESTDIR=${pkgdir} install
}
