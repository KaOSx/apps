
pkgname=audacity
pkgver=3.0.3
pkgrel=1
pkgdesc="A program that lets you manipulate digital audio waveforms"
arch=('x86_64')
url=""
license=('GPL')
depends=('libvorbis' 'libmad' 'libid3tag' 'gtk2' 'lame' 'hicolor-icon-theme' 'ffmpeg'
         'shared-mime-info' 'desktop-file-utils' 'redland' 'jack' 'soundtouch' 'libsoxr'
         'lilv' 'flac' 'libsndfile' 'libsamplerate' 'suil' 'portmidi')
makedepends=('cmake' 'zip' 'pkgconfig')
options=('!makeflags')
source=("https://github.com/audacity/audacity/archive/Audacity-${pkgver}.tar.gz")
sha256sums=('36fe7079e76f88755d3b3a15584ab4e7587968dddbcc5b12889517dc45a6bf36')

prepare() {
  cd ${pkgname}-Audacity-${pkgver}

  #sed -i 's|if( NOT ours )|if( ours )|' cmake-proxies/wxWidgets/CMakeLists.txt
}

build() {
  cmake -B build -S ${pkgname}-Audacity-${pkgver} \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DCMAKE_BUILD_TYPE=Release \
    -Daudacity_use_wxwidgets=local \
    -DALWAYS_ALLOW_CONAN_FALLBACK=ON
  cmake --build build
}

package() {

  DESTDIR=${pkgdir} cmake --install build
}

