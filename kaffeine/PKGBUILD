
pkgname=kaffeine
pkgver=2.0.18
_commit=a44b0786c6606e49740ebefbcf4a352619614e32
pkgrel=5
pkgdesc='Media player with support for digital television (DVB-C/S/S2/T, ATSC, CI/CAM)'
license=('GPL')
arch=('x86_64')
url="https://apps.kde.org/kaffeine/"
depends=('kcoreaddons6' 'kdbusaddons6' 'ki18n6' 'solid6' 'kio6'
         'kwidgetsaddons6' 'kwindowsystem6' 'kxmlgui6' 'vlc')
makedepends=('extra-cmake-modules' 'kdoctools6') 
groups=('multimedia')
#source=("https://download.kde.org/stable/kaffeine/${pkgname}-${_pkgver}.tar.xz"
source=("https://invent.kde.org/multimedia/kaffeine/-/archive/${_commit}/kaffeine-${_commit}.tar.bz2")
sha256sums=('06b8e2acc6faf025c2d5c5fb76920d8d9fb93b7a856caacf57c0c19aa3b0de9c')

prepare() {
  cd ${pkgname}-${_commit}
  #patch -p1 -i ${srcdir}/2dbc752d644440f963bad172cf3ec83dc681ec7f.diff
  #sed -i 's|#include <X11/extensions/scrnsaver.h>||' src/mediawidget.cpp
  #rm -r po/pt_BR/docs 
}

build() {
  cmake -B build -S ${pkgname}-${_commit} \
    -DCMAKE_BUILD_TYPE=Release \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DKDE_INSTALL_LIBDIR=lib \
    -DBUILD_TESTING=OFF 
  cmake --build build
}

package() {

  DESTDIR=${pkgdir} cmake --install build
}
